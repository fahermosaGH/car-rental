<h1>Reservas</h1>

<div class="filters">
  <label>
    Estado:
    <select [(ngModel)]="status">
      <option value="">(todos)</option>
      <option value="pending">pending</option>
      <option value="confirmed">confirmed</option>
      <option value="completed">completed</option>
      <option value="cancelled">cancelled</option>
    </select>
  </label>

  <label>
    Desde:
    <input type="date" [(ngModel)]="from" />
  </label>

  <label>
    Hasta:
    <input type="date" [(ngModel)]="to" />
  </label>

  <button type="button" (click)="reload()">Filtrar</button>
</div>

<div *ngIf="loading" class="state">Cargando…</div>
<div *ngIf="!loading && error" class="state error">{{ error }}</div>

<table *ngIf="!loading && rows.length" class="table">
  <thead>
    <tr>
      <th>#</th>
      <th>Usuario</th>
      <th>Vehículo</th>
      <th>Retiro</th>
      <th>Devolución</th>
      <th>Total</th>
      <th>Estado</th>
      <th>Cambiar</th>
    </tr>
  </thead>

  <tbody>
    <tr *ngFor="let r of rows">
      <td>{{ r.id }}</td>
      <td>{{ r.userEmail || '-' }}</td>
      <td>{{ r.vehicle || '-' }}</td>
      <td>{{ r.pickupLocation || '-' }} — {{ r.startAt }}</td>
      <td>{{ r.dropoffLocation || '-' }} — {{ r.endAt }}</td>
      <td>{{ r.totalPrice | currency : 'ARS' }}</td>
      <td>{{ r.status }}</td>

      <td>
        <select [ngModel]="r.status" (ngModelChange)="changeStatus(r, $event)">
          <option value="pending">pending</option>
          <option value="confirmed">confirmed</option>
          <option value="completed">completed</option>
          <option value="cancelled">cancelled</option>
        </select>
      </td>
    </tr>
  </tbody>
</table>

<div *ngIf="!loading && !rows.length" class="state">No hay reservas para mostrar.</div>
