<div class="perfil-wrapper">
  <h2>Mi perfil</h2>

  <div *ngIf="loading" class="estado">Cargando perfil...</div>
  <div *ngIf="!loading && error" class="estado error">{{ error }}</div>

  <form
    *ngIf="!loading && !error && perfil"
    (ngSubmit)="guardar()"
    novalidate
  >
    <div class="grid">
      <div class="field">
        <label>Nombre *</label>
        <input
          type="text"
          [(ngModel)]="perfil.firstName"
          name="firstName"
        />
      </div>
      <div class="field">
        <label>Apellido *</label>
        <input
          type="text"
          [(ngModel)]="perfil.lastName"
          name="lastName"
        />
      </div>
    </div>

    <div class="field">
      <label>Email</label>
      <input type="email" [value]="perfil.email" disabled />
      <small class="help">
        El email se usa para iniciar sesión y no puede cambiarse desde aquí.
      </small>
    </div>

    <div class="grid">
      <div class="field">
        <label>Teléfono móvil *</label>
        <input
          type="text"
          [(ngModel)]="perfil.phone"
          name="phone"
        />
      </div>
      <div class="field">
        <label>DNI / Pasaporte *</label>
        <input
          type="text"
          [(ngModel)]="perfil.documentNumber"
          name="documentNumber"
        />
      </div>
    </div>

    <div class="field">
      <label>Fecha de nacimiento *</label>
      <input
        type="date"
        [(ngModel)]="perfil.birthDate"
        name="birthDate"
      />
      <small class="help">
        Debés tener al menos 21 años para alquilar.
      </small>
    </div>

    <div class="field">
      <label>Dirección de residencia</label>
      <input
        type="text"
        [(ngModel)]="perfil.address"
        name="address"
      />
    </div>

    <h3>Licencia de conducir</h3>

    <div class="grid">
      <div class="field">
        <label>Número de licencia *</label>
        <input
          type="text"
          [(ngModel)]="perfil.licenseNumber"
          name="licenseNumber"
        />
      </div>
      <div class="field">
        <label>País de emisión *</label>
        <input
          type="text"
          [(ngModel)]="perfil.licenseCountry"
          name="licenseCountry"
        />
      </div>
    </div>

    <div class="field">
      <label>Fecha de vencimiento *</label>
      <input
        type="date"
        [(ngModel)]="perfil.licenseExpiry"
        name="licenseExpiry"
      />
    </div>

    <div class="mensajes">
      <p class="ok" *ngIf="successMsg">{{ successMsg }}</p>
      <p class="error" *ngIf="!successMsg && error">{{ error }}</p>
    </div>

    <button
      type="submit"
      class="btn-primary"
      [disabled]="saving"
    >
      {{ saving ? 'Guardando...' : 'Guardar cambios' }}
    </button>
  </form>
</div>

